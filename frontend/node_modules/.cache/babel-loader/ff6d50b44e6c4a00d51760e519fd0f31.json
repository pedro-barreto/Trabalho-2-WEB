{"ast":null,"code":"\"use strict\";\n\nconst momentTz = require(\"moment-timezone\");\n\nconst moment = require(\"moment\");\n\nmodule.exports = BaseTypes => {\n  const warn = BaseTypes.ABSTRACT.warn.bind(void 0, \"https://www.ibm.com/support/knowledgecenter/SSEPGG_11.1.0/com.ibm.db2.luw.sql.ref.doc/doc/r0008478.html\");\n\n  function removeUnsupportedIntegerOptions(dataType) {\n    if (dataType._length || dataType.options.length || dataType._unsigned || dataType._zerofill) {\n      warn(`Db2 does not support '${dataType.key}' with options. Plain '${dataType.key}' will be used instead.`);\n      dataType._length = void 0;\n      dataType.options.length = void 0;\n      dataType._unsigned = void 0;\n      dataType._zerofill = void 0;\n    }\n  }\n\n  BaseTypes.DATE.types.db2 = [\"TIMESTAMP\"];\n  BaseTypes.STRING.types.db2 = [\"VARCHAR\"];\n  BaseTypes.CHAR.types.db2 = [\"CHAR\"];\n  BaseTypes.TEXT.types.db2 = [\"VARCHAR\", \"CLOB\"];\n  BaseTypes.TINYINT.types.db2 = [\"SMALLINT\"];\n  BaseTypes.SMALLINT.types.db2 = [\"SMALLINT\"];\n  BaseTypes.MEDIUMINT.types.db2 = [\"INTEGER\"];\n  BaseTypes.INTEGER.types.db2 = [\"INTEGER\"];\n  BaseTypes.BIGINT.types.db2 = [\"BIGINT\"];\n  BaseTypes.FLOAT.types.db2 = [\"DOUBLE\", \"REAL\", \"FLOAT\"];\n  BaseTypes.TIME.types.db2 = [\"TIME\"];\n  BaseTypes.DATEONLY.types.db2 = [\"DATE\"];\n  BaseTypes.BOOLEAN.types.db2 = [\"BOOLEAN\", \"BOOL\", \"SMALLINT\", \"BIT\"];\n  BaseTypes.BLOB.types.db2 = [\"BLOB\"];\n  BaseTypes.DECIMAL.types.db2 = [\"DECIMAL\"];\n  BaseTypes.UUID.types.db2 = [\"CHAR () FOR BIT DATA\"];\n  BaseTypes.ENUM.types.db2 = [\"VARCHAR\"];\n  BaseTypes.REAL.types.db2 = [\"REAL\"];\n  BaseTypes.DOUBLE.types.db2 = [\"DOUBLE\"];\n  BaseTypes.GEOMETRY.types.db2 = false;\n\n  class BLOB extends BaseTypes.BLOB {\n    toSql() {\n      if (this._length) {\n        if (this._length.toLowerCase() === \"tiny\") {\n          return \"BLOB(255)\";\n        }\n\n        if (this._length.toLowerCase() === \"medium\") {\n          return \"BLOB(16M)\";\n        }\n\n        if (this._length.toLowerCase() === \"long\") {\n          return \"BLOB(2G)\";\n        }\n\n        return `BLOB(${this._length})`;\n      }\n\n      return \"BLOB\";\n    }\n\n    escape(blob) {\n      return `BLOB('${blob.toString().replace(/'/g, \"''\")}')`;\n    }\n\n    _stringify(value) {\n      if (Buffer.isBuffer(value)) {\n        return `BLOB('${value.toString().replace(/'/g, \"''\")}')`;\n      }\n\n      if (Array.isArray(value)) {\n        value = Buffer.from(value);\n      } else {\n        value = Buffer.from(value.toString());\n      }\n\n      const hex = value.toString(\"hex\");\n      return this._hexify(hex);\n    }\n\n    _hexify(hex) {\n      return `x'${hex}'`;\n    }\n\n  }\n\n  class STRING extends BaseTypes.STRING {\n    toSql() {\n      if (!this._binary) {\n        if (this._length <= 4e3) {\n          return `VARCHAR(${this._length})`;\n        }\n\n        return `CLOB(${this._length})`;\n      }\n\n      if (this._length < 255) {\n        return `CHAR(${this._length}) FOR BIT DATA`;\n      }\n\n      if (this._length <= 4e3) {\n        return `VARCHAR(${this._length}) FOR BIT DATA`;\n      }\n\n      return `BLOB(${this._length})`;\n    }\n\n    _stringify(value, options) {\n      if (this._binary) {\n        return BLOB.prototype._hexify(value.toString(\"hex\"));\n      }\n\n      return options.escape(value);\n    }\n\n    _bindParam(value, options) {\n      return options.bindParam(this._binary ? Buffer.from(value) : value);\n    }\n\n  }\n\n  STRING.prototype.escape = false;\n\n  class TEXT extends BaseTypes.TEXT {\n    toSql() {\n      let len = 0;\n\n      if (this._length) {\n        switch (this._length.toLowerCase()) {\n          case \"tiny\":\n            len = 256;\n            break;\n\n          case \"medium\":\n            len = 8192;\n            break;\n\n          case \"long\":\n            len = 65536;\n            break;\n        }\n\n        if (isNaN(this._length)) {\n          this._length = 32672;\n        }\n\n        if (len > 0) {\n          this._length = len;\n        }\n      } else {\n        this._length = 32672;\n      }\n\n      if (this._length > 32672) {\n        len = `CLOB(${this._length})`;\n      } else {\n        len = `VARCHAR(${this._length})`;\n      }\n\n      warn(`Db2 does not support TEXT datatype. ${len} will be used instead.`);\n      return len;\n    }\n\n  }\n\n  class BOOLEAN extends BaseTypes.BOOLEAN {\n    toSql() {\n      return \"BOOLEAN\";\n    }\n\n    _sanitize(value) {\n      if (value !== null && value !== void 0) {\n        if (Buffer.isBuffer(value) && value.length === 1) {\n          value = value[0];\n        }\n\n        if (typeof value === \"string\") {\n          value = value === \"true\" ? true : value === \"false\" ? false : value;\n          value = value === \"\u0001\" ? true : value === \"\\0\" ? false : value;\n        } else if (typeof value === \"number\") {\n          value = value === 1 ? true : value === 0 ? false : value;\n        }\n      }\n\n      return value;\n    }\n\n  }\n\n  BOOLEAN.parse = BOOLEAN.prototype._sanitize;\n\n  class UUID extends BaseTypes.UUID {\n    toSql() {\n      return \"CHAR(36) FOR BIT DATA\";\n    }\n\n  }\n\n  class NOW extends BaseTypes.NOW {\n    toSql() {\n      return \"CURRENT TIME\";\n    }\n\n  }\n\n  class DATE extends BaseTypes.DATE {\n    toSql() {\n      if (this._length < 0) {\n        this._length = 0;\n      }\n\n      if (this._length > 6) {\n        this._length = 6;\n      }\n\n      return `TIMESTAMP${this._length ? `(${this._length})` : \"\"}`;\n    }\n\n    _stringify(date, options) {\n      if (!moment.isMoment(date)) {\n        date = this._applyTimezone(date, options);\n      }\n\n      if (this._length > 0) {\n        let msec = \".\";\n\n        for (let i = 0; i < this._length && i < 6; i++) {\n          msec += \"S\";\n        }\n\n        return date.format(`YYYY-MM-DD HH:mm:ss${msec}`);\n      }\n\n      return date.format(\"YYYY-MM-DD HH:mm:ss\");\n    }\n\n    static parse(value) {\n      if (typeof value !== \"string\") {\n        value = value.string();\n      }\n\n      if (value === null) {\n        return value;\n      }\n\n      value = new Date(momentTz.utc(value));\n      return value;\n    }\n\n  }\n\n  class DATEONLY extends BaseTypes.DATEONLY {\n    static parse(value) {\n      return momentTz(value).format(\"YYYY-MM-DD\");\n    }\n\n  }\n\n  class INTEGER extends BaseTypes.INTEGER {\n    constructor(length) {\n      super(length);\n      removeUnsupportedIntegerOptions(this);\n    }\n\n  }\n\n  class TINYINT extends BaseTypes.TINYINT {\n    constructor(length) {\n      super(length);\n      removeUnsupportedIntegerOptions(this);\n    }\n\n  }\n\n  class SMALLINT extends BaseTypes.SMALLINT {\n    constructor(length) {\n      super(length);\n      removeUnsupportedIntegerOptions(this);\n    }\n\n  }\n\n  class BIGINT extends BaseTypes.BIGINT {\n    constructor(length) {\n      super(length);\n      removeUnsupportedIntegerOptions(this);\n    }\n\n  }\n\n  class REAL extends BaseTypes.REAL {\n    constructor(length, decimals) {\n      super(length, decimals);\n\n      if (this._length || this.options.length || this._unsigned || this._zerofill) {\n        warn(\"Db2 does not support REAL with options. Plain `REAL` will be used instead.\");\n        this._length = void 0;\n        this.options.length = void 0;\n        this._unsigned = void 0;\n        this._zerofill = void 0;\n      }\n    }\n\n  }\n\n  class FLOAT extends BaseTypes.FLOAT {\n    constructor(length, decimals) {\n      super(length, decimals);\n\n      if (this._decimals) {\n        warn(\"Db2 does not support Float with decimals. Plain `FLOAT` will be used instead.\");\n        this._length = void 0;\n        this.options.length = void 0;\n      }\n\n      if (this._unsigned) {\n        warn(\"Db2 does not support Float unsigned. `UNSIGNED` was removed.\");\n        this._unsigned = void 0;\n      }\n\n      if (this._zerofill) {\n        warn(\"Db2 does not support Float zerofill. `ZEROFILL` was removed.\");\n        this._zerofill = void 0;\n      }\n    }\n\n  }\n\n  class ENUM extends BaseTypes.ENUM {\n    toSql() {\n      return \"VARCHAR(255)\";\n    }\n\n  }\n\n  class DOUBLE extends BaseTypes.DOUBLE {\n    constructor(length, decimals) {\n      super(length, decimals);\n\n      if (this._length || this.options.length || this._unsigned || this._zerofill) {\n        warn(\"db2 does not support DOUBLE with options. Plain DOUBLE will be used instead.\");\n        this._length = void 0;\n        this.options.length = void 0;\n        this._unsigned = void 0;\n        this._zerofill = void 0;\n      }\n    }\n\n    toSql() {\n      return \"DOUBLE\";\n    }\n\n  }\n\n  DOUBLE.prototype.key = DOUBLE.key = \"DOUBLE\";\n  return {\n    BLOB,\n    BOOLEAN,\n    ENUM,\n    STRING,\n    UUID,\n    DATE,\n    DATEONLY,\n    NOW,\n    TINYINT,\n    SMALLINT,\n    INTEGER,\n    DOUBLE,\n    \"DOUBLE PRECISION\": DOUBLE,\n    BIGINT,\n    REAL,\n    FLOAT,\n    TEXT\n  };\n};","map":{"version":3,"sources":["C:\\Users\\Pedro\\codigos\\Trabalho-2-WEB\\frontend\\node_modules\\sequelize\\lib\\dialects\\db2\\data-types.js"],"names":[],"mappings":"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","sourcesContent":["'use strict';\n\nconst momentTz = require('moment-timezone');\nconst moment = require('moment');\n\nmodule.exports = BaseTypes => {\n  const warn = BaseTypes.ABSTRACT.warn.bind(undefined,\n    'https://www.ibm.com/support/knowledgecenter/SSEPGG_11.1.0/' +\n    'com.ibm.db2.luw.sql.ref.doc/doc/r0008478.html');\n\n  /**\n   * Removes unsupported Db2 options, i.e., LENGTH, UNSIGNED and ZEROFILL,\n   * for the integer data types.\n   *\n   * @param {object} dataType The base integer data type.\n   * @private\n   */\n  function removeUnsupportedIntegerOptions(dataType) {\n    if (dataType._length || dataType.options.length || dataType._unsigned || dataType._zerofill) {\n      warn(`Db2 does not support '${dataType.key}' with options. Plain '${dataType.key}' will be used instead.`);\n      dataType._length = undefined;\n      dataType.options.length = undefined;\n      dataType._unsigned = undefined;\n      dataType._zerofill = undefined;\n    }\n  }\n\n  /**\n   * types: [hex, ...]\n   *\n   * @see Data types and table columns: https://www.ibm.com/support/knowledgecenter/en/SSEPGG_11.1.0/com.ibm.db2.luw.admin.dbobj.doc/doc/c0055357.html \n   */\n\n  BaseTypes.DATE.types.db2 = ['TIMESTAMP'];\n  BaseTypes.STRING.types.db2 = ['VARCHAR'];\n  BaseTypes.CHAR.types.db2 = ['CHAR'];\n  BaseTypes.TEXT.types.db2 = ['VARCHAR', 'CLOB'];\n  BaseTypes.TINYINT.types.db2 = ['SMALLINT'];\n  BaseTypes.SMALLINT.types.db2 = ['SMALLINT'];\n  BaseTypes.MEDIUMINT.types.db2 = ['INTEGER'];\n  BaseTypes.INTEGER.types.db2 = ['INTEGER'];\n  BaseTypes.BIGINT.types.db2 = ['BIGINT'];\n  BaseTypes.FLOAT.types.db2 = ['DOUBLE', 'REAL', 'FLOAT'];\n  BaseTypes.TIME.types.db2 = ['TIME'];\n  BaseTypes.DATEONLY.types.db2 = ['DATE'];\n  BaseTypes.BOOLEAN.types.db2 = ['BOOLEAN', 'BOOL', 'SMALLINT', 'BIT'];\n  BaseTypes.BLOB.types.db2 = ['BLOB'];\n  BaseTypes.DECIMAL.types.db2 = ['DECIMAL'];\n  BaseTypes.UUID.types.db2 = ['CHAR () FOR BIT DATA'];\n  BaseTypes.ENUM.types.db2 = ['VARCHAR'];\n  BaseTypes.REAL.types.db2 = ['REAL'];\n  BaseTypes.DOUBLE.types.db2 = ['DOUBLE'];\n  BaseTypes.GEOMETRY.types.db2 = false;\n\n  class BLOB extends BaseTypes.BLOB {\n    toSql() {\n      if (this._length) {\n        if (this._length.toLowerCase() === 'tiny') { // tiny = 255 bytes\n          return 'BLOB(255)';\n        }\n        if (this._length.toLowerCase() === 'medium') { // medium = 16M\n          return 'BLOB(16M)';\n        }\n        if (this._length.toLowerCase() === 'long') { // long = 2GB\n          return 'BLOB(2G)';\n        }\n        return `BLOB(${ this._length })`;\n      }\n      return 'BLOB'; // 1MB\n    }\n    escape(blob) {\n      return `BLOB('${ blob.toString().replace(/'/g, \"''\") }')`;\n    }\n    _stringify(value) {\n      if (Buffer.isBuffer(value)) {\n        return `BLOB('${ value.toString().replace(/'/g, \"''\") }')`;\n      }\n      if (Array.isArray(value)) {\n        value = Buffer.from(value);\n      } else {\n        value = Buffer.from(value.toString());\n      }\n      const hex = value.toString('hex');\n      return this._hexify(hex);\n    }\n    _hexify(hex) {\n      return `x'${ hex }'`;\n    }\n  }\n\n  class STRING extends BaseTypes.STRING {\n    toSql() {\n      if (!this._binary) {\n        if (this._length <= 4000) {\n          return `VARCHAR(${ this._length })`;\n        }\n        return `CLOB(${ this._length })`;\n      }\n      if (this._length < 255) {\n        return `CHAR(${ this._length }) FOR BIT DATA`;\n      }\n      if (this._length <= 4000) {\n        return `VARCHAR(${ this._length }) FOR BIT DATA`;\n      }\n      return `BLOB(${ this._length })`;\n    }\n    _stringify(value, options) {\n      if (this._binary) {\n        return BLOB.prototype._hexify(value.toString('hex'));\n      }\n      return options.escape(value);\n    }\n    _bindParam(value, options) {\n      return options.bindParam(this._binary ? Buffer.from(value) : value);\n    }\n  }\n  STRING.prototype.escape = false;\n\n  class TEXT extends BaseTypes.TEXT {\n    toSql() {\n      let len = 0;\n      if (this._length) {\n        switch (this._length.toLowerCase()) {\n          case 'tiny':\n            len = 256; // tiny = 2^8\n            break;\n          case 'medium':\n            len = 8192; // medium = 2^13 = 8k\n            break;\n          case 'long':\n            len = 65536; // long = 64k\n            break;\n        }\n        if ( isNaN(this._length) ) {\n          this._length = 32672;\n        }\n        if (len > 0 ) { this._length = len; }\n      } else { this._length = 32672; }\n      if ( this._length > 32672 )\n      {\n        len = `CLOB(${ this._length })`;\n      }\n      else\n      {\n        len = `VARCHAR(${ this._length })`;\n      }\n      warn(`Db2 does not support TEXT datatype. ${len} will be used instead.`);\n      return len;\n    }\n  }\n\n  class BOOLEAN extends BaseTypes.BOOLEAN {\n    toSql() {\n      return 'BOOLEAN';\n    }\n    _sanitize(value) {\n      if (value !== null && value !== undefined) {\n        if (Buffer.isBuffer(value) && value.length === 1) {\n          // Bit fields are returned as buffers\n          value = value[0];\n        }\n\n        if (typeof value === 'string') {\n          // Only take action on valid boolean strings.\n          value = value === 'true' ? true : value === 'false' ? false : value;\n          value = value === '\\u0001' ? true : value === '\\u0000' ? false : value;\n\n        } else if (typeof value === 'number') {\n          // Only take action on valid boolean integers.\n          value = value === 1 ? true : value === 0 ? false : value;\n        }\n      }\n\n      return value;\n    }\n  }\n  BOOLEAN.parse = BOOLEAN.prototype._sanitize;\n\n  class UUID extends BaseTypes.UUID {\n    toSql() {\n      return 'CHAR(36) FOR BIT DATA';\n    }\n  }\n\n  class NOW extends BaseTypes.NOW {\n    toSql() {\n      return 'CURRENT TIME';\n    }\n  }\n\n  class DATE extends BaseTypes.DATE {\n    toSql() {\n      if (this._length < 0) { this._length = 0; }\n      if (this._length > 6) { this._length = 6; }\n      return `TIMESTAMP${ this._length ? `(${ this._length })` : ''}`;\n    }\n    _stringify(date, options) {\n      if (!moment.isMoment(date)) {\n        date = this._applyTimezone(date, options);\n      }\n\n      if (this._length > 0) {\n        let msec = '.';\n        for ( let i = 0; i < this._length && i < 6; i++ ) {\n          msec += 'S';\n        }\n        return date.format(`YYYY-MM-DD HH:mm:ss${msec}`);\n      }\n      return date.format('YYYY-MM-DD HH:mm:ss');\n    }\n    static parse(value) {\n      if (typeof value !== 'string') {\n        value = value.string();\n      }\n      if (value === null) {\n        return value;\n      }\n      value = new Date(momentTz.utc(value));\n      return value;\n    }\n  }\n\n  class DATEONLY extends BaseTypes.DATEONLY {\n    static parse(value) {\n      return momentTz(value).format('YYYY-MM-DD');\n    }\n  }\n\n  class INTEGER extends BaseTypes.INTEGER {\n    constructor(length) {\n      super(length);\n      removeUnsupportedIntegerOptions(this);\n    }\n  }\n\n  class TINYINT extends BaseTypes.TINYINT {\n    constructor(length) {\n      super(length);\n      removeUnsupportedIntegerOptions(this);\n    }\n  }\n\n  class SMALLINT extends BaseTypes.SMALLINT {\n    constructor(length) {\n      super(length);\n      removeUnsupportedIntegerOptions(this);\n    }\n  }\n\n  class BIGINT extends BaseTypes.BIGINT {\n    constructor(length) {\n      super(length);\n      removeUnsupportedIntegerOptions(this);\n    }\n  }\n\n  class REAL extends BaseTypes.REAL {\n    constructor(length, decimals) {\n      super(length, decimals);\n      // Db2 does not support any options for real\n      if (this._length || this.options.length || this._unsigned || this._zerofill) {\n        warn('Db2 does not support REAL with options. Plain `REAL` will be used instead.');\n        this._length = undefined;\n        this.options.length = undefined;\n        this._unsigned = undefined;\n        this._zerofill = undefined;\n      }\n    }\n  }\n\n  class FLOAT extends BaseTypes.FLOAT {\n    constructor(length, decimals) {\n      super(length, decimals);\n      // Db2 does only support lengths as option.\n      // Values between 1-24 result in 7 digits precision (4 bytes storage size)\n      // Values between 25-53 result in 15 digits precision (8 bytes size)\n      // If decimals are provided remove these and print a warning\n      if (this._decimals) {\n        warn('Db2 does not support Float with decimals. Plain `FLOAT` will be used instead.');\n        this._length = undefined;\n        this.options.length = undefined;\n      }\n      if (this._unsigned) {\n        warn('Db2 does not support Float unsigned. `UNSIGNED` was removed.');\n        this._unsigned = undefined;\n      }\n      if (this._zerofill) {\n        warn('Db2 does not support Float zerofill. `ZEROFILL` was removed.');\n        this._zerofill = undefined;\n      }\n    }\n  }\n\n  class ENUM extends BaseTypes.ENUM {\n    toSql() {\n      return 'VARCHAR(255)';\n    }\n  }\n\n  class DOUBLE extends BaseTypes.DOUBLE {\n    constructor(length, decimals) {\n      super(length, decimals);\n      // db2 does not support any parameters for double\n      if (this._length || this.options.length ||\n          this._unsigned || this._zerofill)\n      {\n        warn('db2 does not support DOUBLE with options. ' +\n             'Plain DOUBLE will be used instead.');\n        this._length = undefined;\n        this.options.length = undefined;\n        this._unsigned = undefined;\n        this._zerofill = undefined;\n      }\n    }\n    toSql() {\n      return 'DOUBLE';\n    }\n  }\n  DOUBLE.prototype.key = DOUBLE.key = 'DOUBLE';\n\n  return {\n    BLOB,\n    BOOLEAN,\n    ENUM,\n    STRING,\n    UUID,\n    DATE,\n    DATEONLY,\n    NOW,\n    TINYINT,\n    SMALLINT,\n    INTEGER,\n    DOUBLE,\n    'DOUBLE PRECISION': DOUBLE,\n    BIGINT,\n    REAL,\n    FLOAT,\n    TEXT\n  };\n};\n"]},"metadata":{},"sourceType":"script"}